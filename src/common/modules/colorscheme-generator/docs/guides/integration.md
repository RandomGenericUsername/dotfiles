# Integration Guide

**Module:** `colorscheme_generator`
**Last Updated:** 2025-10-18

---

## Overview

This guide shows how to integrate the `colorscheme_generator` module with other systems and applications.

---

## Integration with Dotfiles Installer

### Module Structure

The `colorscheme_generator` is a UV project within the dotfiles repository:

```
dotfiles/
├── cli/                          # Dotfiles installer (separate venv)
│   └── config/
│       └── settings.toml         # Installer settings
└── modules/
    └── colorscheme_generator/    # Runtime module (separate venv)
        ├── pyproject.toml
        ├── uv.lock
        └── src/colorscheme_generator/
```

### Separate Virtual Environments

- **Installer venv:** For CLI dependencies (click, dynaconf, etc.)
- **Runtime venv:** For colorscheme_generator dependencies (PIL, pywal, etc.)

### Configuration Location

Settings file location: `cli/config/settings.toml`

```toml
[colorscheme_generator.output]
directory = "$HOME/.cache/colorscheme"
formats = ["json", "css", "sh"]

[colorscheme_generator.generation]
default_backend = "pywal"
```

---

## Integration with Wallpaper Manager

### Automatic Color Generation on Wallpaper Change

```python
from pathlib import Path
from colorscheme_generator import (
    ColorSchemeGeneratorFactory,
    OutputManager,
    Settings,
    GeneratorConfig,
)

class WallpaperManager:
    def __init__(self):
        self.settings = Settings.get()
        self.generator = ColorSchemeGeneratorFactory.create_auto(self.settings)
        self.output_manager = OutputManager(self.settings)

    def set_wallpaper(self, wallpaper_path: Path):
        """Set wallpaper and generate colors."""
        # Set wallpaper (using feh, nitrogen, etc.)
        self._apply_wallpaper(wallpaper_path)

        # Generate colors
        config = GeneratorConfig.from_settings(self.settings)
        scheme = self.generator.generate(wallpaper_path, config)

        # Write output files
        output_files = self.output_manager.write_outputs(
            scheme,
            config.output_dir,
            config.formats
        )

        # Reload applications
        self._reload_applications(output_files)

        return scheme

    def _apply_wallpaper(self, wallpaper_path: Path):
        """Apply wallpaper using system tool."""
        import subprocess
        subprocess.run(["feh", "--bg-fill", str(wallpaper_path)])

    def _reload_applications(self, output_files: dict):
        """Reload applications with new colors."""
        # Reload terminal emulator
        # Reload window manager
        # etc.
        pass
```

---

## Integration with Terminal Emulators

### Alacritty

Generate Alacritty color configuration:

```python
def generate_alacritty_config(scheme, output_path: Path):
    """Generate Alacritty color configuration."""
    config = f"""
# Generated by colorscheme_generator
# Source: {scheme.source_image}
# Backend: {scheme.backend}

[colors.primary]
background = '{scheme.background.hex}'
foreground = '{scheme.foreground.hex}'

[colors.cursor]
text = '{scheme.background.hex}'
cursor = '{scheme.cursor.hex}'

[colors.normal]
black   = '{scheme.colors[0].hex}'
red     = '{scheme.colors[1].hex}'
green   = '{scheme.colors[2].hex}'
yellow  = '{scheme.colors[3].hex}'
blue    = '{scheme.colors[4].hex}'
magenta = '{scheme.colors[5].hex}'
cyan    = '{scheme.colors[6].hex}'
white   = '{scheme.colors[7].hex}'

[colors.bright]
black   = '{scheme.colors[8].hex}'
red     = '{scheme.colors[9].hex}'
green   = '{scheme.colors[10].hex}'
yellow  = '{scheme.colors[11].hex}'
blue    = '{scheme.colors[12].hex}'
magenta = '{scheme.colors[13].hex}'
cyan    = '{scheme.colors[14].hex}'
white   = '{scheme.colors[15].hex}'
"""
    output_path.write_text(config)
```

### Kitty

Generate Kitty color configuration:

```python
def generate_kitty_config(scheme, output_path: Path):
    """Generate Kitty color configuration."""
    config = f"""
# Generated by colorscheme_generator
# Source: {scheme.source_image}

background {scheme.background.hex}
foreground {scheme.foreground.hex}
cursor {scheme.cursor.hex}

# Black
color0 {scheme.colors[0].hex}
color8 {scheme.colors[8].hex}

# Red
color1 {scheme.colors[1].hex}
color9 {scheme.colors[9].hex}

# Green
color2 {scheme.colors[2].hex}
color10 {scheme.colors[10].hex}

# Yellow
color3 {scheme.colors[3].hex}
color11 {scheme.colors[11].hex}

# Blue
color4 {scheme.colors[4].hex}
color12 {scheme.colors[12].hex}

# Magenta
color5 {scheme.colors[5].hex}
color13 {scheme.colors[13].hex}

# Cyan
color6 {scheme.colors[6].hex}
color14 {scheme.colors[14].hex}

# White
color7 {scheme.colors[7].hex}
color15 {scheme.colors[15].hex}
"""
    output_path.write_text(config)
```

---

## Integration with Window Managers

### i3/Sway

Generate i3/Sway color configuration:

```python
def generate_i3_config(scheme, output_path: Path):
    """Generate i3/Sway color configuration."""
    bg = scheme.background.hex
    fg = scheme.foreground.hex
    cursor = scheme.cursor.hex

    config = f"""
# Generated by colorscheme_generator
# Source: {scheme.source_image}

# class                 border  backgr. text    indicator child_border
client.focused          {cursor} {cursor} {fg}   {cursor}  {cursor}
client.focused_inactive {bg}     {bg}     {fg}   {bg}      {bg}
client.unfocused        {bg}     {bg}     {fg}   {bg}      {bg}
client.urgent           {scheme.colors[1].hex} {scheme.colors[1].hex} {fg} {scheme.colors[1].hex} {scheme.colors[1].hex}
client.placeholder      {bg}     {bg}     {fg}   {bg}      {bg}

client.background       {bg}
"""
    output_path.write_text(config)
```

---

## Integration with Text Editors

### Neovim/Vim

Generate Vim color scheme:

```python
def generate_vim_colorscheme(scheme, output_path: Path):
    """Generate Vim color scheme."""
    config = f"""
\" Generated by colorscheme_generator
\" Source: {scheme.source_image}

set background=dark
hi clear
if exists("syntax_on")
  syntax reset
endif

let g:colors_name = "generated"

hi Normal       guifg={scheme.foreground.hex} guibg={scheme.background.hex}
hi Cursor       guifg={scheme.background.hex} guibg={scheme.cursor.hex}
hi Visual       guibg={scheme.colors[8].hex}
hi Comment      guifg={scheme.colors[8].hex}
hi String       guifg={scheme.colors[2].hex}
hi Number       guifg={scheme.colors[3].hex}
hi Keyword      guifg={scheme.colors[4].hex}
hi Function     guifg={scheme.colors[6].hex}
hi Type         guifg={scheme.colors[5].hex}
hi Error        guifg={scheme.colors[1].hex}
hi Todo         guifg={scheme.colors[3].hex}
"""
    output_path.write_text(config)
```

---

## Integration with Web Applications

### CSS Variables

The module already generates CSS with variables. Use them in web apps:

```css
/* Generated by colorscheme_generator */
:root {
  --background: #1a1a1a;
  --foreground: #ffffff;
  --cursor: #ff0000;
  --color0: #000000;
  /* ... */
}

/* Use in your styles */
body {
  background-color: var(--background);
  color: var(--foreground);
}

a {
  color: var(--color4); /* Blue */
}

.error {
  color: var(--color1); /* Red */
}
```

---

## Integration with System Services

### Systemd Service

Create a systemd service to generate colors on wallpaper change:

```ini
# ~/.config/systemd/user/colorscheme-generator.service
[Unit]
Description=Color Scheme Generator
After=graphical-session.target

[Service]
Type=oneshot
ExecStart=/path/to/venv/bin/python -m colorscheme_generator.cli %I

[Install]
WantedBy=default.target
```

### Systemd Path Unit

Watch for wallpaper changes:

```ini
# ~/.config/systemd/user/colorscheme-generator.path
[Unit]
Description=Watch for wallpaper changes

[Path]
PathChanged=%h/.config/wallpaper/current

[Install]
WantedBy=default.target
```

---

## Integration with Notification Systems

### Desktop Notifications

Notify user when colors are generated:

```python
import subprocess

def notify_color_generation(scheme):
    """Send desktop notification."""
    subprocess.run([
        "notify-send",
        "Color Scheme Generated",
        f"Generated from {scheme.source_image.name}\n"
        f"Backend: {scheme.backend}\n"
        f"Background: {scheme.background.hex}"
    ])

# Usage
scheme = generator.generate(image_path, config)
notify_color_generation(scheme)
```

---

## Integration with Configuration Management

### Ansible Integration

Use in Ansible playbooks:

```yaml
# playbook.yml
- name: Generate color scheme
  command: >
    /path/to/venv/bin/python -m colorscheme_generator.cli
    {{ wallpaper_path }}
    --backend pywal
    --output-dir {{ ansible_env.HOME }}/.config/colors
  register: colorscheme_result

- name: Reload applications
  command: "{{ item }}"
  loop:
    - i3-msg reload
    - killall -USR1 kitty
```

---

## Next Steps

- **[Usage Patterns](usage_patterns.md)** - Common usage patterns
- **[Templates Guide](templates.md)** - Working with templates
- **[Examples](../reference/examples.md)** - Comprehensive examples

# Usage Guide

## Basic Usage

### Launching the Viewer

```bash
# Basic launch
rofi -show colors -modi "colors:rofi-colorscheme-viewer"

# With custom theme
rofi -show colors -modi "colors:rofi-colorscheme-viewer" -theme ~/.config/rofi/colorscheme-viewer.rasi

# With custom colorscheme file
ROFI_COLORSCHEME_VIEWER_PATHS__COLORSCHEME_FILE=/path/to/colors.json \
  rofi -show colors -modi "colors:rofi-colorscheme-viewer"
```

### Keyboard Navigation

- **Arrow Keys**: Navigate through colors
- **Enter**: Copy selected color to clipboard
- **Escape**: Close the viewer
- **Mouse Click**: Select and copy color

### Format Switching

Click the format selector at the top to cycle through formats:

1. **Hex Format**: `#1a1b26`
2. **RGB Format**: `rgb(26, 27, 38)`
3. **JSON Format**: `{"r": 26, "g": 27, "b": 38}`

The format selector shows checkboxes indicating the current format:
```
ðŸŽ¨ Format: [âœ“] Hex  [ ] Rgb  [ ] Json
```

When you click it, the format cycles and the menu refreshes seamlessly without closing.

## Configuration

### Settings File

Edit `config/settings.toml`:

```toml
[paths]
# Path to colorscheme JSON file
colorscheme_file = "~/.cache/colorscheme/colors.json"

# Directory for temporary swatch images
temp_dir = "/tmp/rofi-colorscheme-viewer"

[rofi]
# Show color swatch icons
show_icons = true

# Size of swatch images in pixels
swatch_size = 100

[formats]
# Available formats
available = ["hex", "rgb", "json"]

# Default format on launch
default = "hex"

[logging]
# Logging level (DEBUG, INFO, WARNING, ERROR)
level = "INFO"
```

### Environment Variables

Override settings via environment variables:

```bash
# Change colorscheme file
export ROFI_COLORSCHEME_VIEWER_PATHS__COLORSCHEME_FILE=/path/to/colors.json

# Change temp directory
export ROFI_COLORSCHEME_VIEWER_PATHS__TEMP_DIR=/tmp/my-swatches

# Change default format
export ROFI_COLORSCHEME_VIEWER_FORMATS__DEFAULT=rgb

# Change logging level
export ROFI_COLORSCHEME_VIEWER_LOGGING__LEVEL=DEBUG
```

## Integration with Dotfiles System

### Colorscheme Generation

The viewer reads colorschemes generated by the colorscheme-generator module:

```bash
# Generate colorscheme
colorscheme-generator generate ~/wallpapers/mountain.png

# View colorscheme
rofi -show colors -modi "colors:rofi-colorscheme-viewer"
```

### Keybinding Setup

Add to your window manager config (e.g., Hyprland):

```conf
# Hyprland config
bind = SUPER, C, exec, rofi -show colors -modi "colors:rofi-colorscheme-viewer" -theme ~/.config/rofi/colorscheme-viewer.rasi
```

### Rofi Theme Customization

The rofi theme is located at `~/.config/rofi/colorscheme-viewer.rasi`. Key customization points:

```rasi
/* Window size */
window {
    width: 25%;  /* Adjust width */
}

/* Number of visible items */
listview {
    lines: 8;  /* Show 8 items at a time */
}

/* Swatch size */
element-icon {
    size: 32px;  /* Icon size */
}

/* Element padding */
element {
    padding: 5px 10px;  /* Vertical and horizontal padding */
}
```

## Advanced Usage

### Custom Colorscheme Format

The viewer expects colorschemes in this JSON format:

```json
{
  "metadata": {
    "source_image": "/path/to/wallpaper.png",
    "backend": "pywal",
    "generated_at": "2024-01-15T14:30:22"
  },
  "special": {
    "background": {
      "hex": "#1a1b26",
      "rgb": [26, 27, 38]
    },
    "foreground": {
      "hex": "#c0caf5",
      "rgb": [192, 202, 245]
    },
    "cursor": {
      "hex": "#c0caf5",
      "rgb": [192, 202, 245]
    }
  },
  "colors": [
    {
      "hex": "#15161e",
      "rgb": [21, 22, 30]
    },
    ...
  ]
}
```

### Programmatic Usage

```python
from pathlib import Path
from rofi_colorscheme_viewer.config.config import ViewerConfig
from rofi_colorscheme_viewer.viewer.colorscheme_viewer import ColorschemeViewer

# Load config
config = ViewerConfig(
    colorscheme_file=Path("~/.cache/colorscheme/colors.json"),
    temp_dir=Path("/tmp/rofi-colorscheme-viewer"),
    show_icons=True,
    swatch_size=100,
    available_formats=["hex", "rgb", "json"],
    default_format="hex"
)

# Create viewer
viewer = ColorschemeViewer(config)

# Show menu (for rofi script mode)
viewer.show_menu()

# Handle selection
viewer.handle_selection("Background  #1a1b26")
```

## Troubleshooting

### Colors Not Displaying

Check that the colorscheme file exists and is valid JSON:

```bash
cat ~/.cache/colorscheme/colors.json | jq .
```

### Swatches Not Showing

Ensure ImageMagick is installed:

```bash
which convert
convert --version
```

### Clipboard Not Working

Ensure wl-clipboard is installed:

```bash
which wl-copy
```

### Format Not Persisting

Check that the temp directory is writable:

```bash
ls -la /tmp/rofi-colorscheme-viewer/
```

## Tips and Tricks

1. **Quick Color Picking**: Use keyboard navigation to quickly browse colors and press Enter to copy
2. **Format Shortcuts**: Remember the format order (Hex â†’ RGB â†’ JSON) for quick cycling
3. **Theme Matching**: The viewer uses your current colorscheme colors, so it always matches your setup
4. **Swatch Caching**: Swatches are cached, so subsequent launches are faster

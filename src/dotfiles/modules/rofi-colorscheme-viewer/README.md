# Rofi Colorscheme Viewer

A rofi-based colorscheme viewer for browsing and copying colors from generated colorschemes.

## Overview

This module provides a rofi interface for viewing colorschemes generated by the colorscheme-generator module. It displays colors with visual swatches and allows copying color values in multiple formats (hex, RGB, JSON).

## Features

- **Visual Color Display**: Shows color swatches alongside color names and values
- **Multiple Formats**: Switch between hex, RGB, and JSON formats on-the-fly
- **Seamless Format Switching**: Format selector stays open when cycling formats (no jarring reload)
- **Clipboard Integration**: Copy colors to clipboard with a single click (wl-copy)
- **Metadata Display**: Shows colorscheme source image, backend, and generation timestamp
- **Compact UI**: Clean, scrollable interface showing 8 colors at a time
- **Dynamic Swatch Generation**: Generates color swatches on-the-fly using ImageMagick

## Installation

The module is automatically installed by the dotfiles installer. Manual installation:

```bash
cd src/dotfiles/modules/rofi-colorscheme-viewer
make install
```

## Usage

### Basic Usage

```bash
# Launch the colorscheme viewer with rofi
rofi -show colors -modi "colors:rofi-colorscheme-viewer"

# With custom theme
rofi -show colors -modi "colors:rofi-colorscheme-viewer" -theme ~/.config/rofi/colorscheme-viewer.rasi
```

### Rofi Script Mode

The module operates in rofi script mode:

```bash
# List mode (ROFI_RETV=0) - Display colors
ROFI_RETV=0 rofi-colorscheme-viewer

# Selection mode (ROFI_RETV=1) - Handle selection
echo "Background  rgb(26, 27, 38)" | ROFI_RETV=1 rofi-colorscheme-viewer
```

### Format Switching

Click the format selector at the top to cycle through formats:
- **Hex**: `#1a1b26`
- **RGB**: `rgb(26, 27, 38)`
- **JSON**: `{"r": 26, "g": 27, "b": 38}`

The format selector uses checkboxes to show the current format and stays open when cycling.

## Configuration

Configuration is located at `config/settings.toml`:

```toml
[paths]
colorscheme_file = "~/.cache/colorscheme/colors.json"
temp_dir = "/tmp/rofi-colorscheme-viewer"

[rofi]
show_icons = true
swatch_size = 100

[formats]
available = ["hex", "rgb", "json"]
default = "hex"

[logging]
level = "INFO"
```

### Configuration Options

- `paths.colorscheme_file`: Path to the colorscheme JSON file
- `paths.temp_dir`: Directory for temporary swatch images
- `rofi.show_icons`: Enable/disable color swatch icons
- `rofi.swatch_size`: Size of color swatch images in pixels
- `formats.available`: List of available color formats
- `formats.default`: Default format to display on launch
- `logging.level`: Logging level (DEBUG, INFO, WARNING, ERROR)

## Architecture

See [docs/architecture.md](docs/architecture.md) for detailed architecture documentation.

## API

See [docs/api.md](docs/api.md) for API documentation.

## Color Formats

### Hex Format
```
#1a1b26
```

### RGB Format
```
rgb(26, 27, 38)
```

### JSON Format
```json
{"r": 26, "g": 27, "b": 38}
```

## Rofi Theme

The module uses a custom rofi theme located at `~/.config/rofi/colorscheme-viewer.rasi`. Key features:

- **Compact window**: 25% width, centered
- **8 visible items**: Scrollable list for all colors
- **Color swatches**: 32px icons showing actual colors
- **Metadata header**: Shows source image, backend, and generation time
- **Dynamic styling**: Uses pywal colors and wallpaper background

## Development

```bash
# Install dependencies
make install

# Run tests
make test

# Run linter
make lint

# Format code
make format

# Clean virtual environment
make clean-venv
```

## Dependencies

- **Python 3.12+**
- **ImageMagick**: For swatch generation (`convert` command)
- **wl-clipboard**: For clipboard operations (`wl-copy` command)
- **rofi**: For the UI
- **colorscheme-generator**: For colorscheme data structures

## License

Part of the dotfiles system.
